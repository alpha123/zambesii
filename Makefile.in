.PHONY=

include Makefile.vars
#
# Zambesii Kernel top-level makefile.
#
iso9660: zambesii.iso
	cp -f zambesii.zxe iso/zambesii
	genisoimage -R -b boot/grub/stage2_eltorito -no-emul-boot \
	-boot-load-size 4 -boot-info-table -V zambesii -o zambesii.iso iso

# For my personal use. (~lp).
imm:
	cp -f zambesii.zxe /media/hddExtended/zambesii.zxe
	cp -f zambesii.iso /media/hddExtended/zambesii.iso

zambesii.iso: exec

exec: zambesii.zxe

zambesii.zxe: __kcore drivers libraries resources programs
	$(LD) -T core/__klinkScript.ld -o $@ \
		core.o

__kcore: core.o
programs: programs.ekf
libraries: libraries.ekf
resources: resources.ekf
drivers: drivers.ekf

# All of these files are presented by their relevant driectories.
core.o:
	@echo xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
	@echo Building core/
	@echo xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
	cd core; make

programs.ekf:
#	@echo xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
#	@echo Building programs/
#	@echo xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
#	cd programs; make

libraries.ekf:
#	@echo xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
#	@echo Building libraries/
#	@echo xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
#	cd libraries; make

resources.ekf:
#	@echo xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
#	@echo Building resources/
#	@echo xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
#	cd resources; make

drivers.ekf:
#	@echo xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
#	@echo Building drivers/
#	@echo xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
#	cd drivers; make

# Top level clean target
clean: fonyphile
	rm -f *.o *.ekf *.zxe *.iso *.img
	cd core; make clean
#	cd programs; make clean
#	cd libraries; make clean
#	cd resources; make clean
#	cd drivers; make clean

aclean: fonyphile
	rm -f *.o *.ekf *.zxe *.iso *.fat
	cd core; make aclean
#	cd programs; make aclean
#	cd libraries; make aclean
#	cd resources; make aclean
#	cd drivers; make aclean

fonyphile:
	rm -f clean aclean

# Spotless removes the configuration created by the coonfigure script.
distclean: fonyphile clean
	rm -f Makefile.vars config.h Makefile
# Only execute this script here. Should never be called by the user explicitly.
#	./.unconfigure

