{Basically, you need the following functions:}

function spawnStream(bankId:numaBankId_t, cpuId:cpu_t): error_t
var
	bank:		numaCpuBankC;
	err:		error_t;
	cs:		cpuStreamC;

begin
	bank := cpuTrib.getBank(bankId);
	if bank = __KNULL
	then
		{Create a new bank.}
		err := cpuTrib.createBank(bankId);
		if err <> ERROR_SUCCESS
		then
			spawnStream := err;
			exit;
		end;

		cpuTrib.availableBanks.setSingle(bankId);
	end;

	{Create new CPU Stream object for the new CPU.}
	cs = new cpuStreamC(bankId, cpuId);
	{Add it to the list of CPUs.}
	err := cpus.addItem(cpuId, cs);
	if err <> ERROR_SUCCESS
	then
		spawnStream := err;
		exit;
	end;
	cpuTrib.availableCpus.setSingle(cpuId);
	cpuTrib.getBank(bankId)^.cpus.setSingle(cpuId);

	spawnStream := ERROR_SUCCESS;
end;


	
